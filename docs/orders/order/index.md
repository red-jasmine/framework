---
title: 订单
outline: deep
---

## 领域模型

```plantuml
<!--@include: ./order.puml-->
```

## 统一语言表

|   名称   |    英文    |                     描述                      |
|:------:|:--------:|:-------------------------------------------:|
|   订单   |  order   |                 基于订单结算的一个整体                 |
|   商品   | product  |                                             |
| 商品库存单位 |   sku    |                                             |
|   买家   |  buyer   |                                             |
|   卖家   |  seller  |                                             |
|  供应商   | supplier |                                             |
|   导购   |  Guide   |                                             |
|   渠道   | channel  |                                             |
|  客户端   |  client  |                                             |
|   来源   |  source  | 用于区分站内的下单来源,source_type 来源类型,source_id 来源ID |

## 订单金额计算

- 商品售价 * 数量
- 计算商品优惠
- 商品应付金额
- 计算订单优惠,分摊订单优惠
- 计算订单运费,分摊订单运费
- 计算商品税费 = 商品应付金额 * 税费比例
- 订单金额 = 商品应付金额 + 订单运费 - 订单优惠 + 商品税费

| 名称       | 编码                 | 值                          |
|----------|--------------------|----------------------------|
| 价格       | price_amount       | 商品单价                       |
| 数量       | quantity           | 下单数量                       |
| 商品总价     | total_price_amount | 价格 * 数量                    |
| 优惠金额     | product_amount     | 商品优惠的金额                    |
| 商品金额     |                    | 商品总价 - 优惠金额                |
| 分摊后商品金额  |                    | 商品金额 - 分摊订单优惠 + 分摊运费       |
| 商品税费     |                    | 分摊后商品金额 * 税率               |
| 商品应付金额   |                    | 分摊后商品金额 + 商品税费             |
| -------- |                    | --------                   |
| 总商品金额    |                    | 商品金额 总和                    |
| 订单优惠     |                    | 订单级别优惠                     |
| 运费       |                    | 订单运费                       |
| 总商品税费    |                    | 商品税费 总和                    |
| 订单应付金额   |                    | 总商品金额 + 运费  - 订单优惠 + 总商品税费 |




